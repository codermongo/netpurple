<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NetPurple - Tools</title>
    <link rel="stylesheet" href="../style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="icon" type="image/x-icon" href="../logo.png">
    <style>
        .back-button {
            position: fixed;
            top: 2rem;
            left: 6rem;
            z-index: 1001;
            padding: 8px 16px;
            background: var(--card-glass-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--card-glass-stroke);
            border-radius: 20px;
            color: var(--text-primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .back-button:hover {
            background: var(--card-glass-hover);
            transform: translateY(-2px);
        }

        /* Controls Section */
        .controls {
            max-width: 900px;
            margin: 0 auto 2rem auto;
            padding: 0 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .search-container {
            position: relative;
            width: 100%;
        }

        .search-input {
            width: 100%;
            padding: 12px 40px 12px 16px;
            background: var(--card-glass-bg);
            backdrop-filter: blur(12px);
            border: 1px solid var(--card-glass-stroke);
            border-radius: 12px;
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            font-size: 1rem;
            outline: none;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            background: var(--card-glass-hover);
            border-color: var(--accent-purple);
            box-shadow: 0 0 0 2px rgba(139, 92, 246, 0.2);
        }

        .search-icon {
            position: absolute;
            right: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            pointer-events: none;
        }

        .category-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            justify-content: center;
        }

        .category-btn {
            padding: 6px 14px;
            background: var(--card-glass-bg);
            border: 1px solid var(--card-glass-stroke);
            border-radius: 20px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }

        .category-btn:hover {
            background: var(--card-glass-hover);
            color: var(--text-primary);
            transform: translateY(-1px);
        }

        .category-btn.active {
            background: var(--button-purple);
            color: white;
            border-color: var(--button-purple);
            box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3);
        }

        /* List Styles */
        #list-container {
            grid-template-columns: 1fr;
            max-width: 900px;
            margin: 0 auto;
        }

        #list-container .tool-card {
            flex-direction: row;
            align-items: center;
            text-align: left;
            gap: 1.5rem;
            padding: 1rem 1.5rem;
        }

        #list-container .tool-icon {
            font-size: 1.2rem;
            margin-bottom: 0;
        }

        #list-container h3 {
            margin-bottom: 0;
            font-size: 1rem;
            min-width: 180px;
        }

        #list-container p {
            margin-bottom: 0;
            flex-grow: 1;
            font-size: 0.9rem;
        }

        #list-container .tool-button {
            margin-top: 0;
            padding: 6px 12px;
            font-size: 0.75rem;
            white-space: nowrap;
        }

        /* Icon Colors */
        .icon-windows { color: #0078D6; }
        .icon-linux { color: #FCC624; } /* Standard Linux Yellow */
        .icon-android { color: #3DDC84; }
        .icon-ios { color: #A2AAAD; }
        
        /* 18+ Badge */
        .icon-18plus {
            border: 2px solid #ef4444;
            color: #ef4444;
            border-radius: 4px;
            padding: 2px 4px;
            font-weight: 700;
            font-family: 'Inter', sans-serif;
            font-size: 0.8rem;
            display: inline-block;
            line-height: 1;
            min-width: 24px;
            text-align: center;
        }
    </style>
</head>
<body>
    <!-- Theme Toggle Container -->
    <div class="theme-toggle-container">
        <!-- Dark/Light Mode Toggle -->
        <button class="menu-item-circle visible" id="themeToggleItem" aria-label="Toggle dark mode">
            <svg class="theme-icon sun-icon" width="20" height="20" viewBox="0 0 24 24" fill="none">
                <circle cx="12" cy="12" r="5" stroke="currentColor" stroke-width="2"/>
                <path d="M12 1v4m0 14v4M1 12h4m14 0h4M4.22 4.22l2.83 2.83m10.9 10.9l2.83 2.83M4.22 19.78l2.83-2.83m10.9-10.9l2.83-2.83" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
            </svg>
            <svg class="theme-icon moon-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
            </svg>
        </button>
    </div>

    <a href="../" class="back-button"><i class="fa-solid fa-arrow-left"></i> Back</a>

    <!-- Hintergrund-Partikel -->
    <canvas id="bg-particles" aria-hidden="true"></canvas>

    <section class="hero" style="min-height: 25vh; padding-top: 100px;">
        <div class="hero-content">
            <h1 class="hero-title">Useful Tools</h1>
            <p class="hero-subtitle">Tools you didn't know you needed</p>
        </div>
    </section>

    <!-- Controls -->
    <div class="controls">
        <div class="search-container">
            <input type="text" id="searchInput" class="search-input" placeholder="Search tools...">
            <i class="fa-solid fa-magnifying-glass search-icon"></i>
        </div>
        <div class="category-filters" id="categoryFilters">
            <button class="category-btn active" data-category="all"><i class="fa-solid fa-list"></i> All</button>
            <!-- Categories injected by JS -->
        </div>
    </div>

    <section class="services">
        <div class="container">
            <div class="tools-grid" id="list-container">
                <!-- Content injected by JS -->
            </div>
        </div>
    </section>

    <script src="../particles.js"></script>
    <script src="../menu.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            let toolsData = [];
            let activeCategory = 'all';

            const container = document.getElementById('list-container');
            const searchInput = document.getElementById('searchInput');
            const filtersContainer = document.getElementById('categoryFilters');

            const categoryIcons = {
                'Remote Access': 'fa-solid fa-desktop',
                'Privacy': 'fa-solid fa-shield-halved',
                'Social': 'fa-solid fa-comments',
                'Windows': 'fa-brands fa-windows',
                'Web': 'fa-solid fa-globe',
                'Information': 'fa-solid fa-circle-info',
                'Kemono 18+': '18+', // Marker for custom handling
                'Self-Hosting': 'fa-solid fa-server',
                'Android': 'fa-brands fa-android',
                'Utilities': 'fa-solid fa-screwdriver-wrench',
                'Linux': 'fa-brands fa-linux',
                'IOS': 'fa-brands fa-apple'
            };

            fetch('data.json')
                .then(response => response.json())
                .then(data => {
                    toolsData = data;
                    renderCategories();
                    renderList();
                })
                .catch(error => console.error('Error loading data:', error));

            // Search functionality
            searchInput.addEventListener('input', (e) => {
                renderList();
            });

            function getCategoryIcon(category) {
                return categoryIcons[category] || 'fa-solid fa-folder';
            }

            function getCategoryColorClass(category) {
                if (category === 'Windows') return 'icon-windows';
                if (category === 'Linux') return 'icon-linux';
                if (category === 'Android') return 'icon-android';
                if (category === 'IOS') return 'icon-ios';
                return '';
            }

            function getIconHTML(category) {
                if (category === 'Kemono 18+') {
                    return '<span class="icon-18plus">18+</span>';
                }
                const iconClass = getCategoryIcon(category);
                const colorClass = getCategoryColorClass(category);
                return `<i class="${iconClass} ${colorClass}"></i>`;
            }

            function renderCategories() {
                const categories = new Set();
                toolsData.forEach(item => {
                    if (item.category) categories.add(item.category);
                });

                const sortedCategories = Array.from(categories).sort();

                sortedCategories.forEach(category => {
                    const btn = document.createElement('button');
                    btn.className = 'category-btn';
                    
                    // Use the icon helper
                    const iconHTML = getIconHTML(category);
                    
                    btn.innerHTML = `${iconHTML} ${category}`;
                    btn.dataset.category = category;
                    btn.addEventListener('click', () => {
                        // Toggle active class
                        document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        activeCategory = category;
                        renderList();
                    });
                    filtersContainer.appendChild(btn);
                });

                // Re-attach listener to 'All' button
                const allBtn = document.querySelector('.category-btn[data-category="all"]');
                allBtn.addEventListener('click', () => {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    allBtn.classList.add('active');
                    activeCategory = 'all';
                    renderList();
                });
            }

            function renderList() {
                container.innerHTML = '';
                const searchTerm = searchInput.value.toLowerCase();

                const filteredData = toolsData.filter(item => {
                    const matchesSearch = item.name.toLowerCase().includes(searchTerm) || 
                                          item.description.toLowerCase().includes(searchTerm);
                    const matchesCategory = activeCategory === 'all' || item.category === activeCategory;
                    return matchesSearch && matchesCategory;
                });

                if (filteredData.length === 0) {
                    container.innerHTML = '<p style="text-align:center; color: var(--text-secondary); grid-column: 1/-1;">No tools found matching your criteria.</p>';
                    return;
                }

                filteredData.forEach(item => {
                    const card = document.createElement('div');
                    card.className = 'tool-card';
                    card.onclick = () => window.open(item.url, '_blank');
                    
                    const iconHTML = getIconHTML(item.category);

                    card.innerHTML = `
                        <div class="tool-icon">${iconHTML}</div>
                        <h3>${item.name}</h3>
                        <p>${item.description}</p>
                        <button class="tool-button" onclick="event.stopPropagation(); window.open('${item.url}', '_blank')">Visit Site</button>
                    `;
                    container.appendChild(card);
                });
            }
        });
    </script>
</body>
</html>